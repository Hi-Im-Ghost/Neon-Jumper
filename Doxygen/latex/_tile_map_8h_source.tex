\hypertarget{_tile_map_8h_source}{}\doxysection{Tile\+Map.\+h}
\label{_tile_map_8h_source}\index{src/TileMap.h@{src/TileMap.h}}
\mbox{\hyperlink{_tile_map_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef PLATFORMER2D\_TILEMAP\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define PLATFORMER2D\_TILEMAP\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <SFML/Graphics.hpp>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_tile_set_8h}{TileSet.h}}"{}}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_layer_8h}{Layer.h}}"{}}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <cmath>}}
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{keyword}{class }\mbox{\hyperlink{class_tile_map}{TileMap}} : \textcolor{keyword}{public} sf::Drawable, \textcolor{keyword}{public} sf::Transformable \{}
\DoxyCodeLine{10 \textcolor{keyword}{public}:}
\DoxyCodeLine{11     \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_tile_map_af4b93ab43aa7a1d6a707ddd7173b6c10}{load}}(\mbox{\hyperlink{class_tile_set}{TileSet}} tileset, \mbox{\hyperlink{class_layer}{Layer}} layer) \{}
\DoxyCodeLine{12         tex.loadFromFile(tileset.\mbox{\hyperlink{class_tile_set_a54b601b224260a5f04c6915461c8f44c}{getImage}}());}
\DoxyCodeLine{13 }
\DoxyCodeLine{14         verts.setPrimitiveType(sf::Quads);}
\DoxyCodeLine{15         verts.resize(layer.\mbox{\hyperlink{class_layer_a39e3b346235715e15d99a0a8ac95e0a7}{getWidth}}() * layer.\mbox{\hyperlink{class_layer_a974c0866509db4c131f8f38d281fbcd1}{getHeight}}() * 4);}
\DoxyCodeLine{16 }
\DoxyCodeLine{17         std::vector<int> data = layer.\mbox{\hyperlink{class_layer_abd8ad603c5223d39187225e1fce2ac72}{getData}}();}
\DoxyCodeLine{18 }
\DoxyCodeLine{19         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < data.size(); i++) \{}
\DoxyCodeLine{20             \textcolor{keywordflow}{if} (data[i] != 0) \{}
\DoxyCodeLine{21                 \textcolor{keywordtype}{size\_t} columns = tileset.\mbox{\hyperlink{class_tile_set_a1abfb2a123c3cf7c3ee8ededeeeb7ad6}{getColumns}}();}
\DoxyCodeLine{22                 \textcolor{keywordtype}{size\_t} val = data[i] -\/ tileset.\mbox{\hyperlink{class_tile_set_a2f62e9ee145a6d3056061cd67dca2406}{getFirstGid}}();}
\DoxyCodeLine{23 }
\DoxyCodeLine{24                 \textcolor{keywordtype}{size\_t} y = floor(val / columns);}
\DoxyCodeLine{25                 \textcolor{keywordtype}{size\_t} x = val \% columns;}
\DoxyCodeLine{26 }
\DoxyCodeLine{27                 \textcolor{keywordtype}{size\_t} yPos = floor(i / layer.\mbox{\hyperlink{class_layer_a39e3b346235715e15d99a0a8ac95e0a7}{getWidth}}());}
\DoxyCodeLine{28                 \textcolor{keywordtype}{size\_t} xPos = i \% layer.\mbox{\hyperlink{class_layer_a39e3b346235715e15d99a0a8ac95e0a7}{getWidth}}();}
\DoxyCodeLine{29 }
\DoxyCodeLine{30                 sf::Vertex* quad = \&verts[i*4];}
\DoxyCodeLine{31 }
\DoxyCodeLine{32                 \textcolor{keywordtype}{float} xPos1 = xPos * tileset.\mbox{\hyperlink{class_tile_set_a950dd1e0e25fd562c61aace8d24fdf8e}{getTileWidth}}();}
\DoxyCodeLine{33                 \textcolor{keywordtype}{float} xPos2 = (xPos + 1) * tileset.\mbox{\hyperlink{class_tile_set_a950dd1e0e25fd562c61aace8d24fdf8e}{getTileWidth}}();}
\DoxyCodeLine{34                 \textcolor{keywordtype}{float} yPos1 = yPos * tileset.\mbox{\hyperlink{class_tile_set_aeedceaf4edae81341cfae186dbc8aa62}{getTileHeight}}();}
\DoxyCodeLine{35                 \textcolor{keywordtype}{float} yPos2 = (yPos + 1) * tileset.\mbox{\hyperlink{class_tile_set_aeedceaf4edae81341cfae186dbc8aa62}{getTileHeight}}();}
\DoxyCodeLine{36 }
\DoxyCodeLine{37                 \textcolor{keywordtype}{float} x1 = x * tileset.\mbox{\hyperlink{class_tile_set_a950dd1e0e25fd562c61aace8d24fdf8e}{getTileWidth}}();}
\DoxyCodeLine{38                 \textcolor{keywordtype}{float} x2 = (x + 1) * tileset.\mbox{\hyperlink{class_tile_set_a950dd1e0e25fd562c61aace8d24fdf8e}{getTileWidth}}();}
\DoxyCodeLine{39                 \textcolor{keywordtype}{float} y1 = y * tileset.\mbox{\hyperlink{class_tile_set_aeedceaf4edae81341cfae186dbc8aa62}{getTileHeight}}();}
\DoxyCodeLine{40                 \textcolor{keywordtype}{float} y2 = (y + 1) * tileset.\mbox{\hyperlink{class_tile_set_aeedceaf4edae81341cfae186dbc8aa62}{getTileHeight}}();}
\DoxyCodeLine{41 }
\DoxyCodeLine{42                 quad[0].position = sf::Vector2f(xPos1, yPos1);}
\DoxyCodeLine{43                 quad[1].position = sf::Vector2f(xPos2, yPos1);}
\DoxyCodeLine{44                 quad[2].position = sf::Vector2f(xPos2, yPos2);}
\DoxyCodeLine{45                 quad[3].position = sf::Vector2f(xPos1, yPos2);}
\DoxyCodeLine{46 }
\DoxyCodeLine{47                 quad[0].texCoords = sf::Vector2f(x1, y1);}
\DoxyCodeLine{48                 quad[1].texCoords = sf::Vector2f(x2, y1);}
\DoxyCodeLine{49                 quad[2].texCoords = sf::Vector2f(x2, y2);}
\DoxyCodeLine{50                 quad[3].texCoords = sf::Vector2f(x1, y2);}
\DoxyCodeLine{51             \}}
\DoxyCodeLine{52         \}}
\DoxyCodeLine{53         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{54     \}}
\DoxyCodeLine{55 \textcolor{keyword}{private}:}
\DoxyCodeLine{56     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} draw(sf::RenderTarget\& target, sf::RenderStates states)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{57         states.transform *= getTransform();}
\DoxyCodeLine{58         states.texture = \&tex;}
\DoxyCodeLine{59         target.draw(verts, states);}
\DoxyCodeLine{60     \}}
\DoxyCodeLine{61 }
\DoxyCodeLine{62     sf::VertexArray verts;}
\DoxyCodeLine{63     sf::Texture tex;}
\DoxyCodeLine{64 \};}
\DoxyCodeLine{65 }
\DoxyCodeLine{66 }
\DoxyCodeLine{67 \textcolor{preprocessor}{\#endif }\textcolor{comment}{//PLATFORMER2D\_TILEMAP\_H}}

\end{DoxyCode}
